language: python
sudo: required

# use an older trusty image, because the newer images cause build errors with
# psycopg2 that comes with CKAN<2.8:
#Â   "Error: could not determine PostgreSQL version from '10.1'"
# see https://github.com/travis-ci/travis-ci/issues/8897
dist: trusty
group: deprecated-2017Q4

# matrix
python:
  - 2.7
  - 3.6
env:
  - CKANVERSION=master
  - CKANVERSION=2.8

# tests
services:
  - postgresql
  - redis-server
install:
  - bash bin/travis-build.bash
  - pip install coveralls
script: make test coverage CKAN_PATH=./ckan
after_success:
  - coveralls
